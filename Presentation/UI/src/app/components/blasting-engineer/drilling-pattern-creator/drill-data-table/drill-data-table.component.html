<div class="drill-data-table-container">
  <!-- Density Inputs Section -->
  <div class="density-inputs-section">
    <h3 class="section-title">Explosive Material Properties</h3>
    <div class="inputs-grid">
      <div class="input-group">
        <label for="emulsionDensity">Emulsion Density (g/cm³):</label>
        <input type="number" 
               id="emulsionDensity"
               [(ngModel)]="emulsionDensity"
               (ngModelChange)="onDensityInputChange()"
               min="0.1"
               max="5.0"
               step="0.1"
               class="density-input">
      </div>
      <div class="input-group">
        <label for="anfoeDensity">ANFO Density (g/cm³):</label>
        <input type="number" 
               id="anfoeDensity"
               [(ngModel)]="anfoeDensity"
               (ngModelChange)="onDensityInputChange()"
               min="0.1"
               max="5.0"
               step="0.1"
               class="density-input">
      </div>
      <div class="input-group">
        <label for="emulsionPerHole">Emulsion per Hole (kg):</label>
        <input type="number" 
               id="emulsionPerHole"
               [(ngModel)]="emulsionPerHole"
               (ngModelChange)="onDensityInputChange()"
               min="1"
               max="1000"
               step="1"
               class="density-input">
      </div>
      <div class="input-group">
        <label for="holeDiameter">Hole Diameter (mm):</label>
        <input type="number" 
               id="holeDiameter"
               [(ngModel)]="holeDiameter"
               (ngModelChange)="onHoleDiameterChange()"
               min="50"
               max="300"
               step="1"
               class="density-input">
      </div>
    </div>
  </div>
  
  <div class="excel-table-wrapper">
    <table class="excel-table">
      <thead>
        <tr>
          <th class="excel-header">Hole ID</th>
          <th class="excel-header">Depth (m)</th>
          <th class="excel-header">Stemming (m)</th>
          <th class="excel-header">Spacing (m)</th>
          <th class="excel-header">Burden (m)</th>
          <th class="excel-header">Sub Drill (m)</th>
          <th class="excel-header">Volume (m³)</th>
          <th class="excel-header">ANFO (kg)</th>
          <th class="excel-header">Emulsion (m)</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let element of dataSource" class="excel-row">
          <td class="excel-cell id-cell">{{ element.holeId }}</td>
          <td class="excel-cell editable-cell">
            <input type="number" 
                   [(ngModel)]="element.depth"
                   (blur)="onCellEdit(element, 'depth', element.depth)"
                   (keydown)="onKeyDown($event)"
                   min="0"
                   step="0.1"
                   class="excel-input">
          </td>
          <td class="excel-cell editable-cell">
            <input type="number" 
                   [(ngModel)]="element.stemming"
                   (blur)="onCellEdit(element, 'stemming', element.stemming)"
                   (keydown)="onKeyDown($event)"
                   min="0"
                   step="0.1"
                   class="excel-input">
          </td>
          <td class="excel-cell editable-cell">
            <input type="number" 
                   [(ngModel)]="element.spacing"
                   (blur)="onCellEdit(element, 'spacing', element.spacing)"
                   (keydown)="onKeyDown($event)"
                   min="0"
                   step="0.1"
                   class="excel-input">
          </td>
          <td class="excel-cell editable-cell">
            <input type="number" 
                   [(ngModel)]="element.burden"
                   (blur)="onCellEdit(element, 'burden', element.burden)"
                   (keydown)="onKeyDown($event)"
                   min="0"
                   step="0.1"
                   class="excel-input">
          </td>
          <td class="excel-cell editable-cell">
            <input type="number" 
                   [(ngModel)]="element.subDrill"
                   (blur)="onCellEdit(element, 'subDrill', element.subDrill)"
                   (keydown)="onKeyDown($event)"
                   min="0"
                   step="0.1"
                   class="excel-input">
          </td>
          <td class="excel-cell calculated-cell">{{ element.volume }}</td>
          <td class="excel-cell calculated-cell">{{ element.anfo }}</td>
          <td class="excel-cell calculated-cell">{{ element.emulsion }}</td>
        </tr>
      </tbody>
      <tfoot>
        <tr class="totals-row">
          <td class="excel-cell totals-label">TOTALS</td>
          <td class="excel-cell totals-cell">{{ totals.depth }}</td>
          <td class="excel-cell totals-cell">{{ totals.stemming }}</td>
          <td class="excel-cell totals-cell">{{ totals.spacing }}</td>
          <td class="excel-cell totals-cell">{{ totals.burden }}</td>
          <td class="excel-cell totals-cell">{{ totals.subDrill }}</td>
          <td class="excel-cell totals-cell">{{ totals.volume }}</td>
          <td class="excel-cell totals-cell">{{ totals.anfo }}</td>
          <td class="excel-cell totals-cell">{{ totals.emulsion }}</td>
        </tr>
      </tfoot>
    </table>
  </div>
  
  <div class="button-container">
    <button class="cancel-btn" (click)="onCancel()">Cancel</button>
    <button class="save-btn" (click)="onSave()">Save</button>
  </div>
</div>