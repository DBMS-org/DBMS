<div class="pattern-toolbar" role="toolbar" aria-label="Drilling Pattern Creator">
  <div class="toolbar-content">
    <!-- Left Section: Mode Controls -->
    <div class="toolbar-section left-section">
      <div class="mode-controls">
        <button 
          type="button"
          mat-icon-button
          class="mode-btn"
          [class.active]="isHolePlacementMode"
          [disabled]="disabled"
          (click)="toggleHolePlacementMode()"
          matTooltip="Place Holes"
          [attr.aria-pressed]="isHolePlacementMode"
          aria-label="Toggle hole placement mode">
          <mat-icon>{{ isHolePlacementMode ? 'edit_off' : 'edit' }}</mat-icon>
        </button>

        <button 
          type="button"
          mat-icon-button
          class="mode-btn precise-btn"
          [class.active]="isPreciseMode"
          [disabled]="disabled"
          (click)="togglePreciseMode()"
          matTooltip="Precise Mode"
          [attr.aria-pressed]="isPreciseMode"
          aria-label="Toggle precise mode">
          <mat-icon>{{ isPreciseMode ? 'grid_on' : 'grid_off' }}</mat-icon>
        </button>

        <button 
          type="button"
          mat-icon-button
          class="mode-btn"
          [disabled]="disabled"
          (click)="toggleFullscreen()"
          matTooltip="Full Screen"
          aria-label="Toggle fullscreen">
          <mat-icon>fullscreen</mat-icon>
        </button>
      </div>
    </div>

    <!-- Center Section: Pattern Parameters -->
    <div class="toolbar-section center-section">
      <div class="param-group">
        <div class="param-control">
          <mat-icon class="param-icon">straighten</mat-icon>
          <input 
            type="number"
            class="param-input"
            [formControl]="getFormControl('spacing')"
            placeholder="3.0"
            min="0.5"
            max="10"
            step="0.1"
            matTooltip="Spacing (m)"
            [attr.aria-label]="'Spacing in meters'">
          <span class="param-unit">m</span>
        </div>

        <div class="param-control">
          <mat-icon class="param-icon">height</mat-icon>
          <input 
            type="number"
            class="param-input"
            [formControl]="getFormControl('burden')"
            placeholder="2.5"
            min="0.5"
            max="10"
            step="0.1"
            matTooltip="Burden (m)"
            [attr.aria-label]="'Burden in meters'">
          <span class="param-unit">m</span>
        </div>

        <div class="param-control">
          <mat-icon class="param-icon">vertical_align_bottom</mat-icon>
          <input 
            type="number"
            class="param-input"
            [formControl]="getFormControl('depth')"
            placeholder="10.0"
            min="1"
            max="50"
            step="0.5"
            matTooltip="Depth (m)"
            [attr.aria-label]="'Depth in meters'">
          <span class="param-unit">m</span>
        </div>

        <!-- Selected Hole Depth -->
        <div class="param-control selected-hole" *ngIf="selectedPoint">
          <mat-icon class="param-icon selected">vertical_align_bottom</mat-icon>
          <input 
            type="number"
            class="param-input selected"
            [formControl]="getSelectedHoleControl()"
            [placeholder]="(selectedPoint.depth !== null && selectedPoint.depth !== undefined) ? selectedPoint.depth.toString() : '10.0'"
            min="1"
            max="50"
            step="0.5"
            [matTooltip]="'Depth for hole ' + selectedPoint.id + ' (m)'"
            [attr.aria-label]="'Depth for selected hole ' + selectedPoint.id + ' in meters'">
          <span class="param-unit selected">{{ selectedPoint.id }}</span>
        </div>
      </div>
    </div>

    <!-- Right Section: Actions -->
    <div class="toolbar-section right-section">
      <div class="action-controls">
        <button 
          type="button"
          mat-icon-button
          class="action-btn depth-editor"
          [disabled]="disabled || drillPointsCount === 0"
          (click)="openDepthEditor()"
          matTooltip="Depth Editor"
          aria-label="Open depth editor">
          <mat-icon>table_view</mat-icon>
        </button>

        <button 
          type="button"
          mat-icon-button
          class="action-btn delete"
          [disabled]="disabled || !selectedPoint"
          (click)="onDeletePoint()"
          matTooltip="Delete Point"
          aria-label="Delete selected point">
          <mat-icon>delete</mat-icon>
        </button>

        <button 
          type="button"
          mat-icon-button
          class="action-btn clear"
          [disabled]="disabled || drillPointsCount === 0"
          (click)="onClearAll()"
          matTooltip="Clear All"
          aria-label="Clear all points">
          <mat-icon>clear_all</mat-icon>
        </button>

        <button 
          type="button"
          mat-icon-button
          class="action-btn save"
          [class.saved]="isSaved"
          [disabled]="disabled || drillPointsCount === 0"
          (click)="onSavePattern()"
          matTooltip="Save Pattern"
          aria-label="Save pattern">
          <mat-icon>{{ isSaved ? 'check_circle' : 'save' }}</mat-icon>
        </button>

        <button 
          type="button"
          mat-icon-button
          class="action-btn export"
          [disabled]="disabled || drillPointsCount === 0"
          (click)="onExportToBlastDesigner()"
          matTooltip="To Blast Designer"
          aria-label="Export to blast designer">
          <mat-icon>timeline</mat-icon>
        </button>
      </div>
    </div>
  </div>

  <!-- Error Display -->
  <div class="error-bar" *ngIf="validationErrors.length > 0" role="alert">
    <mat-icon class="error-icon">error</mat-icon>
    <span class="error-text">{{ validationErrors[0] }}</span>
  </div>
</div>