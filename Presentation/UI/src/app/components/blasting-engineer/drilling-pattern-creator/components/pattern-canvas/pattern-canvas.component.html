<!-- Pattern Canvas Component Template -->
<div class="canvas-wrapper">
  <!-- Ruler Corner -->
  <div class="ruler-corner"></div>
  
  <!-- Horizontal Ruler -->
  <div class="ruler-horizontal">
    <!-- Ruler ticks and labels will be generated dynamically -->
  </div>
  
  <!-- Vertical Ruler -->
  <div class="ruler-vertical">
    <!-- Ruler ticks and labels will be generated dynamically -->
  </div>
  
  <div 
    #canvasContainer 
    class="pattern-canvas-container"
    [class.fullscreen]="uiState.isFullscreen"
    [class.hole-placement-mode]="uiState.isHolePlacementMode"
    [class.precise-mode]="uiState.isPreciseMode"
    [attr.aria-label]="'Drilling pattern canvas with ' + drillPoints.length + ' drill points'"
    [attr.tabindex]="0"
    role="application"
    (contextmenu)="onContextMenu($event)"
    (keydown)="onKeyDown($event)"
    (focus)="onCanvasFocus()"
    (blur)="onCanvasBlur()">
    
    <!-- Canvas will be initialized here by Konva -->
    <div id="konva-canvas-container"></div>
  
  <!-- Coordinates display -->
  <div class="coordinates-display" *ngIf="uiState.cursorPosition">
    <span class="coords-label">X:</span> {{ formatValue(uiState.cursorPosition.x) }}
    <span class="coords-label">Y:</span> {{ formatValue(uiState.cursorPosition.y) }}
  </div>
  
  <!-- Zoom controls -->
  <div class="zoom-controls">
    <button 
      type="button" 
      class="zoom-button zoom-in" 
      (click)="zoomIn()"
      aria-label="Zoom in">
      +
    </button>
    <button 
      type="button" 
      class="zoom-button zoom-out" 
      (click)="zoomOut()"
      aria-label="Zoom out">
      -
    </button>
    <button 
      type="button" 
      class="zoom-button zoom-reset" 
      (click)="resetView()"
      aria-label="Reset view">
      ↺
    </button>
    <button 
      type="button" 
      class="zoom-button zoom-fit" 
      (click)="fitToScreen()"
      aria-label="Fit to screen">
      ⤢
    </button>
  </div>
  
  <!-- Mini-map (optional) -->
  <div class="mini-map" *ngIf="drillPoints.length > 0">
    <div class="mini-map-content">
      <!-- Mini-map will be rendered by Konva -->
      <div class="viewport-indicator"></div>
    </div>
  </div>
  
  <!-- Loading overlay -->
  <div 
    *ngIf="isInitializing" 
    class="canvas-loading-overlay"
    role="status"
    aria-live="polite">
    <div class="loading-spinner" aria-hidden="true"></div>
    <span>Initializing canvas...</span>
  </div>
  
  <!-- Error overlay -->
  <div 
    *ngIf="hasError" 
    class="canvas-error-overlay"
    role="alert"
    aria-live="assertive">
    <div class="error-message">
      <h4>Canvas Error</h4>
      <p>{{ errorMessage }}</p>
      <button 
        type="button" 
        class="retry-button"
        (click)="retryInitialization()"
        [attr.aria-label]="'Retry canvas initialization'">
        Retry
      </button>
    </div>
  </div>

  <!-- Tooltip for drill points -->
  <div class="canvas-tooltip" *ngIf="hoveredPoint" [style.left.px]="tooltipPosition.x" [style.top.px]="tooltipPosition.y">
    <div class="tooltip-content">
      <strong>{{ hoveredPoint.id }}</strong>
      <div>X: {{ formatValue(hoveredPoint.x) }}, Y: {{ formatValue(hoveredPoint.y) }}</div>
      <div>Depth: {{ formatValue(hoveredPoint.depth) }}m</div>
    </div>
  </div>

  <!-- Screen reader announcements -->
  <div 
    class="sr-only" 
    aria-live="polite" 
    aria-atomic="true">
    <span *ngIf="canvasState?.isInitialized">
      Canvas ready. {{ drillPoints.length }} drill points loaded.
    </span>
    <span *ngIf="uiState.isHolePlacementMode">
      Hole placement mode active. Click to place drill points.
    </span>
    <span *ngIf="uiState.isPreciseMode">
      Precise mode active. Grid snapping enabled.
    </span>
  </div>

  <!-- Canvas instructions for screen readers -->
  <div class="sr-only">
    <h3>Canvas Instructions</h3>
    <ul>
      <li>Use mouse wheel or pinch to zoom</li>
      <li>Click and drag to pan the view</li>
      <li *ngIf="uiState.isHolePlacementMode">Click to place new drill points</li>
      <li>Right-click for context menu options</li>
      <li>Press Escape to exit fullscreen mode</li>
    </ul>
  </div>
  </div>
</div>

<!-- Hidden styles for screen reader only content -->
<style>
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
</style>