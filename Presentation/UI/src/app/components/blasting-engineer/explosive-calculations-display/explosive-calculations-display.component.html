<div class="calculations-container" role="main" aria-label="Explosive Calculations Display">
  <!-- Compact Professional Header -->
  <header class="compact-header">
    <div class="header-left">
      <div class="title-section">
        <span class="material-icons title-icon">calculate</span>
        <div class="title-text">
          <h1>Explosive Calculations</h1>
          <span class="context-info">Project {{ projectId }} â€¢ Site {{ siteId }}</span>
        </div>
      </div>
    </div>
    <div class="header-right">
      <div class="navigation-controls">
        <button class="nav-btn secondary" (click)="navigateToPatternCreator()" title="Pattern Creator">
          <span class="material-icons">arrow_back</span>
          <span class="btn-text">Pattern</span>
        </button>
        <button class="nav-btn primary" (click)="navigateToSequenceDesigner()" title="Sequence Designer">
          <span class="btn-text">Sequence</span>
          <span class="material-icons">arrow_forward</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content Grid -->
  <div class="main-content-grid" *ngIf="!isLoading && !hasError">
    
    <!-- Left Column: Detailed Results -->
    <div class="results-column">
      <div class="results-card" *ngIf="calculationResults">
        <div class="card-header">
          <span class="material-icons">analytics</span>
          <h2>Calculation Results</h2>
          <div class="data-badge" *ngIf="isBackendDataLoaded()">
            <span class="material-icons">cloud_done</span>
            <span>Live Data</span>
          </div>
        </div>
        
        <div class="results-grid">
          <div class="result-item" *ngFor="let item of getDetailedResults(); let i = index">
            <div class="result-icon">
              <span class="material-icons">{{ item.icon }}</span>
            </div>
            <div class="result-content">
              <span class="result-label">{{ item.parameter }}</span>
              <div class="result-value-unit">
                <span class="result-value">{{ item.value }}</span>
                <span class="result-unit">{{ item.unit }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column: Saved Calculations -->
    <div class="saved-column">
      <div class="saved-card" *ngIf="savedCalculations.length > 0">
        <div class="card-header">
          <span class="material-icons">history</span>
          <h2>Saved Calculations</h2>
          <span class="count-badge">{{ savedCalculations.length }}</span>
        </div>
        
        <div class="saved-list">
          <div class="saved-item" 
               *ngFor="let calculation of savedCalculations; let i = index"
               [class.active]="currentCalculationId === calculation.id">
            <div class="saved-info">
              <div class="saved-header">
                <span class="calc-id">{{ calculation.calculationId }}</span>
                <span class="calc-date">{{ calculation.createdAt | date:'MMM d, y' }}</span>
              </div>
              <div class="calc-metrics">
                <div class="metric">
                  <span class="metric-value">{{ calculation.numberOfFilledHoles }}</span>
                  <span class="metric-label">holes</span>
                </div>
                <div class="metric">
                  <span class="metric-value">{{ calculation.totalEmulsion | number:'1.1-1' }}</span>
                  <span class="metric-label">kg</span>
                </div>
              </div>
            </div>
            <div class="saved-actions">
              <button class="action-btn load" 
                      (click)="loadSavedCalculation(calculation.id)"
                      [disabled]="isLoading"
                      title="Load calculation">
                <span class="material-icons">download</span>
              </button>
              <button class="action-btn delete" 
                      (click)="deleteSavedCalculation(calculation.id)"
                      [disabled]="isLoading"
                      title="Delete calculation">
                <span class="material-icons">delete</span>
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- No saved calculations state -->
      <div class="empty-state" *ngIf="savedCalculations.length === 0">
        <span class="material-icons">folder_open</span>
        <h3>No Saved Calculations</h3>
        <p>No calculations found for this project and site.</p>
      </div>
    </div>
  
  <!-- Loading & Error States -->
  <div class="status-overlay" *ngIf="isLoading || hasError">
    <div class="status-card loading" *ngIf="isLoading">
      <div class="spinner"></div>
      <h3>Loading Calculations</h3>
      <p>Retrieving data from database...</p>
    </div>
    
    <div class="status-card error" *ngIf="hasError">
      <span class="material-icons">error_outline</span>
      <h3>Loading Error</h3>
      <p>{{ errorMessage }}</p>
      <button class="retry-btn" (click)="loadSavedCalculations()">
        <span class="material-icons">refresh</span>
        Retry
      </button>
    </div>
  </div>

</div>