<div class="site-details-container">
  <!-- Header -->
  <div class="site-header">
    <button class="back-button" (click)="goBack()">
      <i class="fas fa-arrow-left"></i> Back to Project
    </button>
    <div class="site-title" *ngIf="site">
      <h1>{{ site.name }}</h1>
      <div class="site-meta">
        <span class="location">
          <i class="fas fa-map-marker-alt"></i> {{ site.location }}
        </span>
        <span class="status" [class]="'status-' + site.status?.toLowerCase()">
          <i class="fas" [class.fa-check-circle]="site.isPatternApproved" 
             [class.fa-clock]="!site.isPatternApproved"></i>
          {{ site.isPatternApproved ? 'Pattern Approved' : 'Pending Approval' }}
        </span>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading site details...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-container">
    <i class="fas fa-exclamation-triangle"></i>
    <p>{{ error }}</p>
  </div>

  <!-- Main Content -->
  <div *ngIf="!loading && !error && site" class="site-content">
    <!-- Navigation Tabs -->
    <div class="tab-navigation">
      <button class="tab-button" 
              [class.active]="activeTab === 'overview'"
              (click)="setActiveTab('overview')">
        <i class="fas fa-info-circle"></i> Overview
      </button>
      <button class="tab-button" 
              [class.active]="activeTab === 'drill-plan'"
              (click)="setActiveTab('drill-plan')">
        <i class="fas fa-drill"></i> Drill Plan
      </button>
    </div>

    <!-- Tab Content -->
    <div class="tab-content">
      <!-- Overview Tab -->
      <div *ngIf="activeTab === 'overview'" class="tab-panel">
        <div class="overview-grid">
          <div class="info-card">
            <h3>Site Information</h3>
            <div class="info-row">
              <span class="label">Name:</span>
              <span class="value">{{ site.name }}</span>
            </div>
            <div class="info-row">
              <span class="label">Description:</span>
              <span class="value">{{ site.description || 'No description available' }}</span>
            </div>
            <div class="info-row">
              <span class="label">Location:</span>
              <span class="value">{{ site.location }}</span>
            </div>
            <div class="info-row">
              <span class="label">Last Updated:</span>
              <span class="value">{{ site.lastUpdated | date:'medium' }}</span>
            </div>
          </div>

          <div class="info-card">
            <h3>Pattern Status</h3>
            <div class="pattern-status">
              <div class="status-indicator" [class.approved]="site.isPatternApproved">
                <i class="fas" [class.fa-check-circle]="site.isPatternApproved" 
                   [class.fa-clock]="!site.isPatternApproved"></i>
                {{ site.isPatternApproved ? 'Approved' : 'Pending' }}
              </div>
              <p class="status-description">
                {{ site.isPatternApproved ? 
                   'Blast pattern has been approved and is ready for execution.' : 
                   'Blast pattern is pending approval from the Blasting Engineer.' }}
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Drill Plan Tab -->
      <div *ngIf="activeTab === 'drill-plan'" class="tab-panel">
        <div class="drill-plan-header">
          <h3>Drill Plan Details</h3>
          <p>Follow the validated blast parameters exactly as specified.</p>
        </div>

        <div class="drill-holes-table">
          <table>
            <thead>
              <tr>
                <th>Hole ID</th>
                <th>Depth (m)</th>
                <th>Burden (m)</th>
                <th>Spacing (m)</th>
                <th>Stemming (m)</th>
                <th>Charge (kg)</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let hole of drillHoles" [class]="'status-' + hole.status">
                <td class="hole-id">{{ hole.id }}</td>
                <td>{{ hole.depth }}</td>
                <td>{{ hole.burden }}</td>
                <td>{{ hole.spacing }}</td>
                <td>{{ hole.stemming }}</td>
                <td>{{ hole.chargeAmount }}</td>
                <td>
                  <span class="status-badge" [class]="'status-' + hole.status">
                    <i class="fas" 
                       [class.fa-clock]="hole.status === 'pending'"
                       [class.fa-check]="hole.status === 'completed'"></i>
                    {{ hole.status | titlecase }}
                  </span>
                </td>
                <td>
                  <button class="action-btn" 
                          [disabled]="hole.status === 'completed'"
                          (click)="markDrillHoleCompleted(hole.id)">
                    {{ hole.status === 'pending' ? 'Mark Completed' : 'Completed' }}
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>