<div class="emulsion-add-container">
  <div class="form-header">
    <h3>Add New Emulsion Batch to Central Warehouse</h3>
    <p>Enter technical specifications for new Emulsion batch based on industry standards</p>
  </div>

  <form class="emulsion-form" [formGroup]="emulsionForm" (ngSubmit)="onSubmit()">
    <div class="form-grid">
      <!-- Core Information -->
      <div class="form-section">
        <h4><i class="material-icons">info</i> Core Information</h4>

        <div class="form-group">
          <label for="batchId">Batch ID * <small>(Format: EMU-YYYY-XXX)</small></label>
          <input
            type="text"
            id="batchId"
            formControlName="batchId"
            placeholder="e.g., EMU-2025-001"
            class="form-control"
            [class.error]="emulsionForm.get('batchId')?.invalid && emulsionForm.get('batchId')?.touched">
          <div class="error-message" *ngIf="emulsionForm.get('batchId')?.invalid && emulsionForm.get('batchId')?.touched">
            <span *ngIf="emulsionForm.get('batchId')?.errors?.['required']">Batch ID is required</span>
            <span *ngIf="emulsionForm.get('batchId')?.errors?.['pattern']">Format must be EMU-YYYY-XXX</span>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="manufacturingDate">Manufacturing Date *</label>
            <input
              type="date"
              id="manufacturingDate"
              formControlName="manufacturingDate"
              class="form-control"
              [class.error]="emulsionForm.get('manufacturingDate')?.invalid && emulsionForm.get('manufacturingDate')?.touched">
            <div class="error-message" *ngIf="emulsionForm.get('manufacturingDate')?.invalid && emulsionForm.get('manufacturingDate')?.touched">
              Manufacturing date is required
            </div>
          </div>

          <div class="form-group">
            <label for="expiryDate">Expiry Date * <small>(+6 months from manufacturing)</small></label>
            <input
              type="date"
              id="expiryDate"
              formControlName="expiryDate"
              class="form-control"
              [class.error]="emulsionForm.get('expiryDate')?.invalid && emulsionForm.get('expiryDate')?.touched">
            <div class="error-message" *ngIf="emulsionForm.get('expiryDate')?.invalid && emulsionForm.get('expiryDate')?.touched">
              Expiry date is required
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="supplier">Supplier *</label>
            <input
              type="text"
              id="supplier"
              formControlName="supplier"
              placeholder="Enter supplier name"
              class="form-control"
              [class.error]="emulsionForm.get('supplier')?.invalid && emulsionForm.get('supplier')?.touched">
            <div class="error-message" *ngIf="emulsionForm.get('supplier')?.invalid && emulsionForm.get('supplier')?.touched">
              Supplier is required
            </div>
          </div>

          <div class="form-group">
            <label for="manufacturerBatchNumber">Manufacturer Batch Number</label>
            <input
              type="text"
              id="manufacturerBatchNumber"
              formControlName="manufacturerBatchNumber"
              placeholder="Optional batch number"
              class="form-control">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="quantity">Quantity *</label>
            <input
              type="number"
              id="quantity"
              formControlName="quantity"
              placeholder="Enter quantity"
              step="0.001"
              class="form-control"
              [class.error]="emulsionForm.get('quantity')?.invalid && emulsionForm.get('quantity')?.touched">
            <div class="error-message" *ngIf="emulsionForm.get('quantity')?.invalid && emulsionForm.get('quantity')?.touched">
              Quantity must be greater than 0
            </div>
          </div>

          <div class="form-group">
            <label for="unit">Unit *</label>
            <select id="unit" formControlName="unit" class="form-control">
              <option value="kg">Kilograms (kg)</option>
              <option value="tons">Tons</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Manufacturing & Central Warehouse Storage -->
      <div class="form-section">
        <h4><i class="material-icons">warehouse</i> Manufacturing & Central Warehouse Storage</h4>

        <div class="form-row">
          <div class="form-group">
            <label for="grade">Grade *</label>
            <select
              id="grade"
              formControlName="grade"
              class="form-control"
              [class.error]="emulsionForm.get('grade')?.invalid && emulsionForm.get('grade')?.touched">
              <option value="Standard">Standard</option>
              <option value="High-Density">High Density</option>
              <option value="Low-Density">Low Density</option>
              <option value="Water-Resistant">Water Resistant</option>
            </select>
            <div class="error-message" *ngIf="emulsionForm.get('grade')?.invalid && emulsionForm.get('grade')?.touched">
              Grade is required
            </div>
          </div>

          <div class="form-group">
            <label for="color">Color *</label>
            <select
              id="color"
              formControlName="color"
              class="form-control"
              [class.error]="emulsionForm.get('color')?.invalid && emulsionForm.get('color')?.touched">
              <option value="White">White</option>
              <option value="Pink">Pink</option>
              <option value="Blue">Blue</option>
              <option value="Red">Red</option>
            </select>
            <div class="error-message" *ngIf="emulsionForm.get('color')?.invalid && emulsionForm.get('color')?.touched">
              Color is required
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="sensitizationType">Sensitization Type *</label>
            <select
              id="sensitizationType"
              formControlName="sensitizationType"
              class="form-control"
              [class.error]="emulsionForm.get('sensitizationType')?.invalid && emulsionForm.get('sensitizationType')?.touched">
              <option value="Chemical">Chemical</option>
              <option value="Physical">Physical</option>
              <option value="Hybrid">Hybrid</option>
            </select>
            <div class="error-message" *ngIf="emulsionForm.get('sensitizationType')?.invalid && emulsionForm.get('sensitizationType')?.touched">
              Sensitization type is required
            </div>
          </div>

          <div class="form-group">
            <label for="sensitizerContent">Sensitizer Content (%)</label>
            <input
              type="number"
              id="sensitizerContent"
              formControlName="sensitizerContent"
              placeholder="e.g., 5"
              step="0.1"
              class="form-control"
              [class.error]="emulsionForm.get('sensitizerContent')?.invalid && emulsionForm.get('sensitizerContent')?.touched">
            <div class="error-message" *ngIf="emulsionForm.get('sensitizerContent')?.invalid && emulsionForm.get('sensitizerContent')?.touched">
              Must be between 0-100%
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="storageLocation">Central Warehouse Location * <small>(Bay/Section/Zone)</small></label>
          <input
            type="text"
            id="storageLocation"
            formControlName="storageLocation"
            placeholder="e.g., Cold Storage A-1, Temperature Controlled Zone 2, Section B-3"
            class="form-control"
            [class.error]="emulsionForm.get('storageLocation')?.invalid && emulsionForm.get('storageLocation')?.touched">
          <div class="error-message" *ngIf="emulsionForm.get('storageLocation')?.invalid && emulsionForm.get('storageLocation')?.touched">
            Storage location within central warehouse is required
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="storageTemperature">Storage Temperature (°C) * <small>(Range: -20 to 50)</small></label>
            <input
              type="number"
              id="storageTemperature"
              formControlName="storageTemperature"
              placeholder="e.g., 20"
              step="0.1"
              class="form-control"
              [class.error]="emulsionForm.get('storageTemperature')?.invalid && emulsionForm.get('storageTemperature')?.touched">
            <div class="error-message" *ngIf="emulsionForm.get('storageTemperature')?.invalid && emulsionForm.get('storageTemperature')?.touched">
              <span *ngIf="emulsionForm.get('storageTemperature')?.errors?.['required']">Temperature is required</span>
              <span *ngIf="emulsionForm.get('storageTemperature')?.errors?.['min'] || emulsionForm.get('storageTemperature')?.errors?.['max']">Must be between -20 to 50°C</span>
            </div>
          </div>

          <div class="form-group">
            <label for="applicationTemperature">Application Temperature (°C) <small>(Range: 0-45)</small></label>
            <input
              type="number"
              id="applicationTemperature"
              formControlName="applicationTemperature"
              placeholder="e.g., 25"
              step="0.1"
              class="form-control"
              [class.error]="emulsionForm.get('applicationTemperature')?.invalid && emulsionForm.get('applicationTemperature')?.touched">
            <div class="error-message" *ngIf="emulsionForm.get('applicationTemperature')?.invalid && emulsionForm.get('applicationTemperature')?.touched">
              Must be between 0-45°C
            </div>
          </div>
        </div>
      </div>

      <!-- Technical Specifications -->
      <div class="form-section">
        <h4>Technical Specifications</h4>
        
        <div class="form-group">
          <label for="densityUnsensitized">Density Unsensitized (g/cm³) * <small>(Range: 1.30-1.45)</small></label>
          <input
            type="number"
            id="densityUnsensitized"
            formControlName="densityUnsensitized"
            placeholder="e.g., 1.38"
            step="0.01"
            class="form-control"
            [class.error]="emulsionForm.get('densityUnsensitized')?.invalid && emulsionForm.get('densityUnsensitized')?.touched">
          <div class="error-message" *ngIf="emulsionForm.get('densityUnsensitized')?.invalid && emulsionForm.get('densityUnsensitized')?.touched">
            <span *ngIf="emulsionForm.get('densityUnsensitized')?.errors?.['required']">Density (unsensitized) is required</span>
            <span *ngIf="emulsionForm.get('densityUnsensitized')?.errors?.['min'] || emulsionForm.get('densityUnsensitized')?.errors?.['max']">Must be between 1.30-1.45 g/cm³</span>
          </div>
        </div>

        <div class="form-group">
          <label for="densitySensitized">Density Sensitized (g/cm³) * <small>(Range: 1.10-1.30)</small></label>
          <input
            type="number"
            id="densitySensitized"
            formControlName="densitySensitized"
            placeholder="e.g., 1.20"
            step="0.01"
            class="form-control"
            [class.error]="emulsionForm.get('densitySensitized')?.invalid && emulsionForm.get('densitySensitized')?.touched">
          <div class="error-message" *ngIf="emulsionForm.get('densitySensitized')?.invalid && emulsionForm.get('densitySensitized')?.touched">
            <span *ngIf="emulsionForm.get('densitySensitized')?.errors?.['required']">Density (sensitized) is required</span>
            <span *ngIf="emulsionForm.get('densitySensitized')?.errors?.['min'] || emulsionForm.get('densitySensitized')?.errors?.['max']">Must be between 1.10-1.30 g/cm³</span>
          </div>
        </div>

        <div class="form-group">
          <label for="viscosity">Viscosity (cP) * <small>(Range: 50,000-200,000)</small></label>
          <input
            type="number"
            id="viscosity"
            formControlName="viscosity"
            placeholder="e.g., 100000"
            step="1000"
            class="form-control"
            [class.error]="emulsionForm.get('viscosity')?.invalid && emulsionForm.get('viscosity')?.touched">
          <div class="error-message" *ngIf="emulsionForm.get('viscosity')?.invalid && emulsionForm.get('viscosity')?.touched">
            <span *ngIf="emulsionForm.get('viscosity')?.errors?.['required']">Viscosity is required</span>
            <span *ngIf="emulsionForm.get('viscosity')?.errors?.['min'] || emulsionForm.get('viscosity')?.errors?.['max']">Must be between 50,000-200,000 cP</span>
          </div>
        </div>

        <div class="form-group">
          <label for="waterContent">Water Content (%) * <small>(Range: 12-16)</small></label>
          <input
            type="number"
            id="waterContent"
            formControlName="waterContent"
            placeholder="e.g., 14"
            step="0.1"
            class="form-control"
            [class.error]="emulsionForm.get('waterContent')?.invalid && emulsionForm.get('waterContent')?.touched">
          <div class="error-message" *ngIf="emulsionForm.get('waterContent')?.invalid && emulsionForm.get('waterContent')?.touched">
            <span *ngIf="emulsionForm.get('waterContent')?.errors?.['required']">Water content is required</span>
            <span *ngIf="emulsionForm.get('waterContent')?.errors?.['min'] || emulsionForm.get('waterContent')?.errors?.['max']">Must be between 12-16%</span>
          </div>
        </div>

        <div class="form-group">
          <label for="pH">pH * <small>(Range: 4.5-6.5)</small></label>
          <input
            type="number"
            id="pH"
            formControlName="pH"
            placeholder="e.g., 5.5"
            step="0.1"
            class="form-control"
            [class.error]="emulsionForm.get('pH')?.invalid && emulsionForm.get('pH')?.touched">
          <div class="error-message" *ngIf="emulsionForm.get('pH')?.invalid && emulsionForm.get('pH')?.touched">
            <span *ngIf="emulsionForm.get('pH')?.errors?.['required']">pH is required</span>
            <span *ngIf="emulsionForm.get('pH')?.errors?.['min'] || emulsionForm.get('pH')?.errors?.['max']">Must be between 4.5-6.5</span>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="detonationVelocity">Detonation Velocity (m/s) <small>(Range: 4500-6000)</small></label>
            <input
              type="number"
              id="detonationVelocity"
              formControlName="detonationVelocity"
              placeholder="e.g., 5500"
              step="10"
              class="form-control"
              [class.error]="emulsionForm.get('detonationVelocity')?.invalid && emulsionForm.get('detonationVelocity')?.touched">
            <div class="error-message" *ngIf="emulsionForm.get('detonationVelocity')?.invalid && emulsionForm.get('detonationVelocity')?.touched">
              Must be between 4500-6000 m/s
            </div>
          </div>

          <div class="form-group">
            <label for="bubbleSize">Bubble Size (μm) <small>(Range: 10-100)</small></label>
            <input
              type="number"
              id="bubbleSize"
              formControlName="bubbleSize"
              placeholder="e.g., 50"
              step="1"
              class="form-control"
              [class.error]="emulsionForm.get('bubbleSize')?.invalid && emulsionForm.get('bubbleSize')?.touched">
            <div class="error-message" *ngIf="emulsionForm.get('bubbleSize')?.invalid && emulsionForm.get('bubbleSize')?.touched">
              Must be between 10-100 μm
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Form Actions -->
    <div class="form-actions">
      <button type="button" class="btn btn-secondary" (click)="onCancel()">
        <i class="material-icons">close</i>
        Cancel
      </button>
      <button type="submit" class="btn btn-primary" [disabled]="emulsionForm.invalid || isSubmitting">
        <i class="material-icons">save</i>
        <span *ngIf="!isSubmitting">Add Emulsion Batch</span>
        <span *ngIf="isSubmitting">Adding...</span>
      </button>
    </div>
  </form>
</div>